<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="kr">
<head>
    <link rel="stylesheet" type="text/css" th:href="@{/css/footer_bottom.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/css/mypage/myPage.css}">

    <meta charset="UTF-8">
    <meta name="_csrf" th:content="${_csrf.token}"/>
    <meta name="_csrf_header" th:content="${_csrf.headerName}"/>

    <title>마이페이지</title>

    <!-- Custom fonts for this template-->
    <link th:href="@{/css/assets/vendor/fontawesome-free/css/all.min.css}" rel="stylesheet" type="text/css">

    <!-- Custom styles for this template-->
    <link th:href="@{/css/assets/css/sb-admin-2.min.css}" rel="stylesheet">

    <!-- Vendor CSS Files -->
    <link th:href="@{/css/assets/vendor/bootstrap/css/bootstrap.min.css}" rel="stylesheet">
    <link th:href="@{/css/assets/vendor/bootstrap-icons/bootstrap-icons.css}" rel="stylesheet">
    <link th:href="@{/css/assets/vendor/simple-datatables/style.css}" rel="stylesheet">

    <!-- Template Main CSS File -->
    <link th:href="@{/css/assets/css/style.css}" rel="stylesheet">
</head>
<body>

<div class="body_container">
    <div th:replace="~{/includes/header :: header}"></div>
    <div class="main_content">

        <div class="my_content">

            <div class="divInform">
                <table class="inFormTable">
                    <tr>
                        <th colspan="2">이동하기</th>
                    </tr>
                    <tr>
                        <td><a class="nav-link collapsed" th:href="@{/myPage}"><i class="bi bi-person"></i> 내 정보</a>
                        </td>
                    </tr>
                    <tr>
                        <td><a class="nav-link collapsed" th:href="@{/myPage/myWishList}"><i
                                class="bi-cart"></i> 찜한 목록</a></td>
                    </tr>

                    <tr>
                        <td><a class="nav-link collapsed" th:href="@{/myPage/reservation}"><i
                                class="bi-calendar-week"></i> 예약 기록</a></td>
                    </tr>

                    <tr>
                        <td><a class="nav-link collapsed" th:href="@{/myPage/rentalManage}"><i
                                class="bi-table"></i> 대여 관리</a></td>
                    </tr>
                    <tr>
                        <td><a class="nav-link collapsed" th:href="@{/myPage/rentalLog}"><i
                                class="bi-cart-check"></i> 대여 기록</a></td>
                    </tr>
                    <tr>
                        <td><a class="nav-link collapsed" th:href="@{/myPage/memberManage}"><i
                                class="bi-person-lines-fill"></i> 회원 관리</a></td>
                    </tr>
                </table>
            </div>

            <div class="pagetitle">
                <h1>내 정보</h1>
                <nav>
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a th:href="@{/}">Home</a></li>
                        <li class="breadcrumb-item">MyPage</li>
                        <li class="breadcrumb-item active">Profile</li>
                    </ol>
                </nav>
            </div>

            <section class="section profile">
                <div class="row">
                    <div class="col-xl-4">

                        <div class="card">
                            <div class="card-body profile-card pt-4 d-flex flex-column align-items-center">
                                <img th:src="@{/css/assets/img/my_profile.png}" alt="Profile"
                                     class="rounded-circle">
                                <h2 th:text="${member.nickname}">이름</h2>
                                <h3 th:text="${member.statusMsg}">상태메세지</h3>
                                <button id="toggleButton">상태메시지 수정하기</button>
                                <input type="text" id="myInput" style="display: none">
                            </div>
                        </div>

                    </div>

                    <div class="col-xl-8">

                        <div class="card">
                            <div class="card-body pt-3">
                                <ul class="nav nav-tabs nav-tabs-bordered" id="tabs">

                                    <li class="nav-item">
                                        <button class="nav-link active" data-bs-toggle="tab"
                                                data-bs-target="#profile-overview">상세보기
                                        </button>
                                    </li>

                                    <li class="nav-item">
                                        <button class="nav-link" data-bs-toggle="tab" data-bs-target="#profile-edit">
                                            프로필 수정
                                        </button>
                                    </li>

                                    <li class="nav-item">
                                        <button class="nav-link" data-bs-toggle="tab"
                                                data-bs-target="#profile-change-password">비밀번호 변경
                                        </button>
                                    </li>

                                    <li class="nav-item">
                                        <button class="nav-link" data-bs-toggle="tab" data-bs-target="#Delete-Account">
                                            회원 탈퇴
                                        </button>
                                    </li>

                                </ul>
                                <div class="tab-content pt-2">

                                    <div class="tab-pane fade show active profile-overview" id="profile-overview">

                                        <h5 class="card-title">상세 정보</h5>
                                        <div class="row">
                                            <div class="col-lg-3 col-md-4 label">이름</div>
                                            <div class="col-lg-9 col-md-8">
                                                <td th:text="${member.nickname}"></td>
                                            </div>
                                        </div>

                                        <div class="row">
                                            <div class="col-lg-3 col-md-4 label">소속</div>
                                            <div class="col-lg-9 col-md-8">
                                                <td th:text="${member.department}"></td>
                                            </div>
                                        </div>

                                        <div class="row">
                                            <div class="col-lg-3 col-md-4 label">상태 메시지
                                            </div>
                                            <!--                                                                                        <div class="col-lg-9 col-md-8"><td th:text="${member.statusMsg}"></td></div>-->
                                        </div>

                                        <div class="row">
                                            <div class="col-lg-3 col-md-4 label">주소
                                            </div>
                                            <div class="col-lg-9 col-md-8">
                                                <td th:text="${member.getMemberAddress().address}"></td>
                                            </div>
                                        </div>

                                        <div class="row">
                                            <div class="col-lg-3 col-md-4 label">전화</div>
                                            <div class="col-lg-9 col-md-8">
                                                <td th:text="${member.phone}"></td>
                                            </div>
                                        </div>

                                        <div class="row">
                                            <div class="col-lg-3 col-md-4 label">Email
                                            </div>
                                            <div class="col-lg-9 col-md-8">
                                                <td th:text="${member.userEmail}"></td>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="tab-pane fade profile-edit pt-3" id="profile-edit">

                                        <form th:action="@{/myPage/updateInfo}" th:object="${memberUpdateForm}"
                                              method="post">
                                            <div class="row mb-3">
                                                <label class="col-md-4 col-lg-3 col-form-label">프로필
                                                    사진</label>
                                                <div class="col-md-8 col-lg-9">
                                                    <img th:src="@{/css/assets/img/my_profile.png}"
                                                         alt="Profile">
                                                    <div class="pt-2">
                                                        <a href="#" class="btn btn-primary btn-sm"
                                                           title="Upload new profile image"><i class="bi bi-upload"></i></a>
                                                        <a href="#" class="btn btn-danger btn-sm"
                                                           title="Remove my profile image"><i
                                                                class="bi bi-trash"></i></a>
                                                    </div>
                                                </div>
                                            </div>


                                            <div class="row mb-3">
                                                <label class="col-md-4 col-lg-3 col-form-label">이름</label>
                                                <div class="col-md-8 col-lg-9">
                                                    <input type="text" class="form-control" th:field="*{nickname}"
                                                           placeholder="이름을 입력하세요">
                                                </div>
                                            </div>

                                            <div class="row mb-3">
                                                <label class="col-md-4 col-lg-3 col-form-label">소속</label>
                                                <div class="col-md-8 col-lg-9">
                                                    <input type="text" class="form-control" th:field="*{department}"
                                                           placeholder="소속을 입력하세요">
                                                </div>
                                            </div>


                                            <div class="row mb-3">
                                                <label class="col-md-4 col-lg-3 col-form-label">주소</label>
                                                <div class="col-md-8 col-lg-9">
                                                    <!--                                                    <input name="address" type="text" class="form-control" id="Address"-->
                                                    <!--                                                           placeholder="주소를 입력하세요">-->
                                                    <input type="text" th:field="*{address.address}"
                                                           class="form-control" placeholder="주소"><br>
                                                    <input type="text" th:field="*{address.detailAddress}"
                                                           class="form-control" placeholder="상세주소">
                                                    <input type="hidden" th:field="*{address.postcode}"
                                                           placeholder="우편번호">
                                                    <input type="button" onclick="execDaumPostcode()"
                                                           onfocus="execDaumPostcode()" value="우편번호 찾기"><br>
                                                    <input type="hidden" th:field="*{address.extraAddress}"
                                                           placeholder="참고항목">
                                                </div>
                                            </div>


                                            <div class="row mb-3">
                                                <label class="col-md-4 col-lg-3 col-form-label">전화</label>
                                                <div class="col-md-8 col-lg-9">
                                                    <input type="text" class="form-control" th:field="*{phone}"
                                                           placeholder="번호를 입력하세요">
                                                </div>
                                            </div>

                                            <div class="text-center">
                                                <button type="submit" class="btn btn-primary">저장하기</button>
                                            </div>
                                        </form>

                                    </div>

                                    <div class="tab-pane fade pt-3" id="profile-change-password">

                                        <form id="myForm" th:action="@{/myPage/updatePw}" th:object="${memberUpdatePw}"
                                              method="post">
                                            <div class="row mb-4">
                                                <div th:if="${result}" th:text="${result}"
                                                     style="color: green"></div>
                                                <label class="col-md-4 col-lg-4 col-form-label">현재
                                                    비밀번호 입력</label>
                                                <div class="col-md-8 col-lg-9">
                                                    <input type="password" class="form-control" th:field="*{pw}">
                                                    <p th:if="${#fields.hasErrors('pw')}" th:errors="*{pw}">
                                                        Incorrect date</p>
                                                    <div th:if="${notSamePw}" th:text="${notSamePw}"
                                                         style="color: red;"></div>
                                                </div>
                                            </div>

                                            <div class="row mb-4">
                                                <label class="col-md-4 col-lg-4 col-form-label">새로운
                                                    비밀번호 입력</label>
                                                <div class="col-md-8 col-lg-9">
                                                    <input type="password" class="form-control" th:field="*{newPw}">
                                                    <p th:if="${#fields.hasErrors('newPw')}" th:errors="*{newPw}">
                                                        Incorrect date</p>
                                                    <div th:if="${notSamePwConfirm}" th:text="${notSamePwConfirm}"
                                                         style="color: red;"></div>
                                                </div>
                                            </div>

                                            <div class="row mb-4">
                                                <label class="col-md-4 col-lg-4 col-form-label">비밀번호
                                                    재입력</label>
                                                <div class="col-md-8 col-lg-9">
                                                    <input type="password" class="form-control"
                                                           th:field="*{newPwRepeat}">
                                                    <p th:if="${#fields.hasErrors('newPwRepeat')}"
                                                       th:errors="*{newPwRepeat}">
                                                        Incorrect date</p>
                                                    <div th:if="${notSamePwConfirm}" th:text="${notSamePwConfirm}"
                                                         style="color: red;"></div>
                                                </div>
                                            </div>

                                            <button type="submit" class="btn btn-primary">비밀번호 변경</button>
                                        </form>
                                    </div>


                                    <div class="tab-pane fade pt-4" id="Delete-Account">
                                        <div class="row mb-4">
                                            <div class="col-md-8 col-lg-9">
                                                <form th:action="@{/myPage/delete}" th:object="${memberDelete}"
                                                      method="post">
                                                    <div class="row mb-4">
                                                        <label
                                                                class="col-md-4 col-lg-4 col-form-label">이메일 입력</label>
                                                        <div class="col-md-8 col-lg-9">
                                                            <input type="text" class="form-control"
                                                                   th:field="*{memberId}">
                                                            <p th:if="${#fields.hasErrors('memberId')}"
                                                               th:errors="*{memberId}">Incorrect date</p>
                                                        </div>
                                                    </div>
                                                    <div class="row mb-4">
                                                        <label class="col-md-4 col-lg-4 col-form-label">비밀번호
                                                            입력</label>
                                                        <div class="col-md-8 col-lg-9">
                                                            <input type="password" class="form-control"
                                                                   th:field="*{memberPw}">
                                                            <p th:if="${#fields.hasErrors('memberPw')}"
                                                               th:errors="*{memberPw}">Incorrect date</p>
                                                            <div th:if="${idpwError}" th:text="${idpwError}"
                                                                 style="color: red;"></div>
                                                        </div>
                                                    </div>
                                                    <button type="submit" class="btn btn-danger">회원 탈퇴하기</button>
                                                </form>


                                                <div class="text-center">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <script th:src="@{/css/assets/vendor/apexcharts/apexcharts.min.js}"></script>
        <script th:src="@{/css/assets/vendor/bootstrap/js/bootstrap.bundle.min.js}"></script>
        <script th:src="@{/css/assets/js/main.js}"></script>
        <script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
        <script th:src="@{/js/myPage/myPage.js}"></script>
        <script th:src="@{/js/login/registerDaumPostCode.js}"></script>
        <script defer th:src="@{/js/mypage/rememberTabActive.js}"></script>

    </div>
    <div th:replace="~{/includes/footer}"></div>
</div>
</body>
</html>